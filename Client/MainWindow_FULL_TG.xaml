<Window x:Class="HardcoreMessenger.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Telegram" 
        Height="800" Width="1400"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterScreen"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Window.Resources>
        <!-- Ð¢ÐžÐ§ÐÐÐ¯ ÐšÐžÐŸÐ˜Ð¯ Ð¦Ð’Ð•Ð¢ÐžÐ’ TELEGRAM -->
        <SolidColorBrush x:Key="TgDarkBg" Color="#0E0E0E"/>
        <SolidColorBrush x:Key="TgPanelBg" Color="#1C1C1E"/>
        <SolidColorBrush x:Key="TgCardBg" Color="#2C2C2E"/>
        <SolidColorBrush x:Key="TgAccent" Color="#8B5CF6"/>
        <SolidColorBrush x:Key="TgTextPrimary" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="TgTextSecondary" Color="#8E8E93"/>
        <SolidColorBrush x:Key="TgBorder" Color="#38383A"/>
        <SolidColorBrush x:Key="TgOnline" Color="#34C759"/>
        <SolidColorBrush x:Key="TgRed" Color="#FF3B30"/>
        
        <!-- Ð“Ñ€Ð°Ð´Ð¸ÐµÐ½Ñ‚Ñ‹ -->
        <LinearGradientBrush x:Key="TgGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#8B5CF6" Offset="0"/>
            <GradientStop Color="#EC4899" Offset="1"/>
        </LinearGradientBrush>
        
        <!-- Ð¡Ñ‚Ð¸Ð»ÑŒ Ð´Ð»Ñ ÐºÑ€ÑƒÐ³Ð»Ñ‹Ñ… ÐºÐ½Ð¾Ð¿Ð¾Ðº Ð¼ÐµÐ½ÑŽ -->
        <Style x:Key="TgMenuButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TgTextPrimary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource TgCardBg}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Ð¡Ñ‚Ð¸Ð»ÑŒ Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº Ñ Ð³Ñ€Ð°Ð´Ð¸ÐµÐ½Ñ‚Ð¾Ð¼ -->
        <Style x:Key="TgGradientButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource TgGradient}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="24,14"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="10"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect Color="#8B5CF6" Opacity="0.5" BlurRadius="20" ShadowDepth="0"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.97" ScaleY="0.97"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Ð¡Ñ‚Ð¸Ð»ÑŒ Ð´Ð»Ñ TextBox -->
        <Style x:Key="TgTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource TgPanelBg}"/>
            <Setter Property="Foreground" Value="{StaticResource TgTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource TgBorder}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="16,14"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="CaretBrush" Value="{StaticResource TgAccent}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                        Padding="{TemplateBinding Padding}"
                                        VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource TgAccent}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Ð¡Ñ‚Ð¸Ð»ÑŒ Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð² -->
        <Style x:Key="TgContactItem" TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}" 
                                Padding="16,12"
                                CornerRadius="8"
                                Margin="8,2">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource TgCardBg}"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                            <GradientStop Color="#1A8B5CF6" Offset="0"/>
                                            <GradientStop Color="#1AEC4899" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Ð¡Ñ‚Ð¸Ð»ÑŒ Ð´Ð»Ñ Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð² Ð¼ÐµÐ½ÑŽ -->
        <Style x:Key="TgMenuItem" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TgTextPrimary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,14"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" 
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="8"
                                Margin="8,2">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource TgCardBg}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border Background="{StaticResource TgDarkBg}" 
            CornerRadius="16"
            BorderBrush="{StaticResource TgBorder}"
            BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect Color="Black" Opacity="0.7" BlurRadius="30" ShadowDepth="0"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð¾ÐºÐ½Ð° -->
            <Border Grid.Row="0" 
                    Background="{StaticResource TgPanelBg}" 
                    CornerRadius="16,16,0,0"
                    BorderBrush="{StaticResource TgBorder}"
                    BorderThickness="0,0,0,1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="24,0">
                        <Border Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#8B5CF6" Offset="0"/>
                                    <GradientStop Color="#EC4899" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <TextBlock Text="â–¶" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White"/>
                        </Border>
                        
                        <TextBlock Text="Telegram" 
                                 FontSize="18" 
                                 FontWeight="Bold"
                                 Foreground="{StaticResource TgTextPrimary}"
                                 VerticalAlignment="Center"/>
                        
                        <TextBlock x:Name="StatusText"
                                 Text="" 
                                 FontSize="12" 
                                 Foreground="{StaticResource TgTextSecondary}"
                                 VerticalAlignment="Center"
                                 Margin="16,0,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,8,0">
                        <Button Content="â€”" Width="44" Height="44" Style="{StaticResource TgMenuButton}" Click="Minimize_Click"/>
                        <Button Content="â˜" Width="44" Height="44" Style="{StaticResource TgMenuButton}" Click="Maximize_Click"/>
                        <Button Content="âœ•" Width="44" Height="44" Click="Close_Click">
                            <Button.Style>
                                <Style TargetType="Button" BasedOn="{StaticResource TgMenuButton}">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="{StaticResource TgRed}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
            <Grid Grid.Row="1">
                <!-- ÐžÐºÐ½Ð¾ Ð²Ñ…Ð¾Ð´Ð° -->
                <Grid x:Name="LoginPanel" Visibility="Visible">
                    <Grid.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#0E0E0E" Offset="0"/>
                            <GradientStop Color="#1C1C1E" Offset="0.5"/>
                            <GradientStop Color="#2C2C2E" Offset="1"/>
                        </LinearGradientBrush>
                    </Grid.Background>

                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Width="420">
                        <Border Width="100" Height="100" CornerRadius="50" HorizontalAlignment="Center" Margin="0,0,0,24">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#8B5CF6" Offset="0"/>
                                    <GradientStop Color="#EC4899" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect Color="#8B5CF6" Opacity="0.6" BlurRadius="30" ShadowDepth="0"/>
                            </Border.Effect>
                            <TextBlock Text="â–¶" FontSize="60" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White"/>
                        </Border>
                        
                        <TextBlock Text="Telegram" 
                                 FontSize="32" 
                                 FontWeight="Bold"
                                 Foreground="{StaticResource TgTextPrimary}"
                                 HorizontalAlignment="Center"
                                 Margin="0,0,0,8"/>
                        
                        <TextBlock Text="HARDCORE Edition" 
                                 FontSize="15" 
                                 Foreground="{StaticResource TgTextSecondary}"
                                 HorizontalAlignment="Center"
                                 Margin="0,0,0,48"/>

                        <TextBlock Text="ENTER YOUR USERNAME" 
                                 FontSize="13" 
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource TgTextSecondary}"
                                 Margin="0,0,0,10"/>
                        
                        <TextBox x:Name="UsernameBox" 
                                Style="{StaticResource TgTextBox}"
                                Height="54"
                                MaxLength="20"
                                KeyDown="UsernameBox_KeyDown"/>

                        <Button Content="START MESSAGING" 
                                Style="{StaticResource TgGradientButton}"
                                Height="54"
                                Margin="0,20,0,0"
                                Click="Login_Click"/>

                        <TextBlock Text="Server: ws://localhost:8080" 
                                 FontSize="11" 
                                 Foreground="{StaticResource TgTextSecondary}"
                                 HorizontalAlignment="Center"
                                 Margin="0,24,0,0"/>
                    </StackPanel>
                </Grid>

                <!-- Ð“Ð»Ð°Ð²Ð½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ -->
                <Grid x:Name="ChatPanel" Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="340"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="340"/>
                    </Grid.ColumnDefinitions>

                    <!-- Ð›Ð•Ð’ÐÐ¯ ÐŸÐÐÐ•Ð›Ð¬ ÐÐÐ’Ð˜Ð“ÐÐ¦Ð˜Ð˜ (ÐºÐ°Ðº Ð² Telegram) -->
                    <Border Grid.Column="0" 
                            Background="{StaticResource TgPanelBg}"
                            BorderBrush="{StaticResource TgBorder}"
                            BorderThickness="0,0,1,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ð¼ÐµÐ½ÑŽ -->
                            <Button Grid.Row="0" 
                                  Margin="0,12,0,0"
                                  Width="56" Height="56"
                                  Click="ToggleMenu_Click"
                                  Style="{StaticResource TgMenuButton}">
                                <StackPanel>
                                    <TextBlock Text="â˜°" FontSize="24" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Button>

                            <!-- ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ -->
                            <StackPanel Grid.Row="1" VerticalAlignment="Top" Margin="0,20,0,0">
                                <Button Width="56" Height="56" Margin="0,8" Style="{StaticResource TgMenuButton}" ToolTip="Chats">
                                    <TextBlock Text="ðŸ’¬" FontSize="24"/>
                                </Button>
                                <Button Width="56" Height="56" Margin="0,8" Style="{StaticResource TgMenuButton}" ToolTip="Contacts">
                                    <TextBlock Text="ðŸ‘¥" FontSize="24"/>
                                </Button>
                                <Button Width="56" Height="56" Margin="0,8" Style="{StaticResource TgMenuButton}" ToolTip="Calls">
                                    <TextBlock Text="ðŸ“ž" FontSize="24"/>
                                </Button>
                                <Button Width="56" Height="56" Margin="0,8" Style="{StaticResource TgMenuButton}" ToolTip="Saved">
                                    <TextBlock Text="ðŸ”–" FontSize="24"/>
                                </Button>
                            </StackPanel>

                            <!-- ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð²Ð½Ð¸Ð·Ñƒ -->
                            <Button Grid.Row="2" 
                                  Width="56" Height="56"
                                  Margin="0,0,0,12"
                                  Click="Profile_Click"
                                  Style="{StaticResource TgMenuButton}">
                                <Border Width="40" Height="40" CornerRadius="20">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="#8B5CF6" Offset="0"/>
                                            <GradientStop Color="#EC4899" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <TextBlock x:Name="NavAvatarText" 
                                             Text="U"
                                             FontSize="18"
                                             FontWeight="Bold"
                                             Foreground="White"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center"/>
                                </Border>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- ÐŸÐÐÐ•Ð›Ð¬ Ð¡ÐŸÐ˜Ð¡ÐšÐ Ð§ÐÐ¢ÐžÐ’ -->
                    <Border Grid.Column="1" 
                            Background="{StaticResource TgPanelBg}"
                            BorderBrush="{StaticResource TgBorder}"
                            BorderThickness="0,0,1,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- ÐŸÐ¾Ð¸ÑÐº -->
                            <Border Grid.Row="0" Padding="16,12" Background="{StaticResource TgCardBg}">
                                <TextBox Style="{StaticResource TgTextBox}" 
                                       Height="44"
                                       Text="ðŸ”  Search..."/>
                            </Border>

                            <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð² -->
                            <ListBox x:Name="UsersList" 
                                   Grid.Row="1"
                                   Background="Transparent"
                                   BorderThickness="0"
                                   ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                   ItemContainerStyle="{StaticResource TgContactItem}"
                                   SelectionChanged="UsersList_SelectionChanged">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Height="68">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="52"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- ÐÐ²Ð°Ñ‚Ð°Ñ€ -->
                                            <Border Grid.Column="0" 
                                                  Width="48" Height="48"
                                                  CornerRadius="24">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                        <GradientStop Color="#8B5CF6" Offset="0"/>
                                                        <GradientStop Color="#EC4899" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <TextBlock Text="{Binding Avatar}" 
                                                         FontSize="20"
                                                         FontWeight="Bold"
                                                         Foreground="White"
                                                         HorizontalAlignment="Center"
                                                         VerticalAlignment="Center"/>
                                            </Border>

                                            <!-- Ð˜Ð¼Ñ Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑ -->
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="14,0">
                                                <TextBlock Text="{Binding Username}" 
                                                         FontSize="16"
                                                         FontWeight="SemiBold"
                                                         Foreground="{StaticResource TgTextPrimary}"/>
                                                <TextBlock Text="{Binding StatusText}" 
                                                         FontSize="13"
                                                         Foreground="{StaticResource TgTextSecondary}"
                                                         Margin="0,3,0,0"/>
                                            </StackPanel>

                                            <!-- ÐžÐ½Ð»Ð°Ð¹Ð½ -->
                                            <Border Grid.Column="2" 
                                                   Width="12" Height="12"
                                                   CornerRadius="6"
                                                   Background="{StaticResource TgOnline}"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,12,0"
                                                   Visibility="{Binding OnlineVisibility}">
                                                <Border.Effect>
                                                    <DropShadowEffect Color="#34C759" Opacity="0.6" BlurRadius="8" ShadowDepth="0"/>
                                                </Border.Effect>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                    </Border>

                    <!-- ÐŸÐÐÐ•Ð›Ð¬ Ð§ÐÐ¢Ð -->
                    <Grid Grid.Column="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="72"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ñ‡Ð°Ñ‚Ð° -->
                        <Border Grid.Row="0" 
                              Background="{StaticResource TgPanelBg}"
                              BorderBrush="{StaticResource TgBorder}"
                              BorderThickness="0,0,0,1"
                              Padding="24,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock x:Name="ChatUsername" 
                                             Text="Select a contact"
                                             FontSize="17"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TgTextPrimary}"/>
                                    <TextBlock x:Name="ChatStatus" 
                                             Text=""
                                             FontSize="13"
                                             Foreground="{StaticResource TgTextSecondary}"
                                             Margin="0,4,0,0"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button Width="44" Height="44" Style="{StaticResource TgMenuButton}" ToolTip="Search">
                                        <TextBlock Text="ðŸ”" FontSize="20"/>
                                    </Button>
                                    <Button Width="44" Height="44" Style="{StaticResource TgMenuButton}" ToolTip="Call" Click="Call_Click">
                                        <TextBlock Text="ðŸ“ž" FontSize="20"/>
                                    </Button>
                                    <Button Width="44" Height="44" Style="{StaticResource TgMenuButton}" ToolTip="More" Click="ChatMenu_Click">
                                        <TextBlock Text="â‹®" FontSize="20"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ -->
                        <ScrollViewer x:Name="MessagesScroll" 
                                    Grid.Row="1"
                                    VerticalScrollBarVisibility="Auto"
                                    Background="{StaticResource TgDarkBg}"
                                    Padding="24">
                            <ItemsControl x:Name="MessagesPanel">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,6">
                                            <Border Background="{Binding BubbleColor}"
                                                  CornerRadius="14,14,14,4"
                                                  Padding="14,10"
                                                  MaxWidth="520"
                                                  HorizontalAlignment="{Binding Alignment}">
                                                <Border.Effect>
                                                    <DropShadowEffect Color="Black" Opacity="0.15" BlurRadius="12" ShadowDepth="3"/>
                                                </Border.Effect>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Content}" 
                                                             FontSize="15"
                                                             Foreground="White"
                                                             TextWrapping="Wrap"
                                                             LineHeight="20"/>
                                                    <TextBlock Text="{Binding TimeString}" 
                                                             FontSize="11"
                                                             Foreground="#C0FFFFFF"
                                                             HorizontalAlignment="Right"
                                                             Margin="0,5,0,0"/>
                                                </StackPanel>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Ð’Ð²Ð¾Ð´ -->
                        <Border Grid.Row="2" 
                              Background="{StaticResource TgPanelBg}"
                              BorderBrush="{StaticResource TgBorder}"
                              BorderThickness="0,1,0,0"
                              Padding="24,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Button Grid.Column="0" Width="44" Height="54" Style="{StaticResource TgMenuButton}" ToolTip="Attach">
                                    <TextBlock Text="ðŸ“Ž" FontSize="20"/>
                                </Button>

                                <TextBox x:Name="MessageBox" 
                                       Grid.Column="1"
                                       Style="{StaticResource TgTextBox}"
                                       Height="54"
                                       Margin="8,0"
                                       TextWrapping="Wrap"
                                       AcceptsReturn="False"
                                       KeyDown="MessageBox_KeyDown"
                                       TextChanged="MessageBox_TextChanged"/>

                                <Button Grid.Column="2" Width="44" Height="54" Style="{StaticResource TgMenuButton}" ToolTip="Emoji">
                                    <TextBlock Text="ðŸ˜Š" FontSize="20"/>
                                </Button>

                                <Button Grid.Column="3" 
                                      Content="âž¤" 
                                      Width="54" Height="54"
                                      Margin="8,0,0,0"
                                      FontSize="20"
                                      Style="{StaticResource TgGradientButton}"
                                      Click="Send_Click"/>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- ÐŸÐ ÐÐ’ÐÐ¯ ÐŸÐÐÐ•Ð›Ð¬ Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜Ð˜ -->
                    <Border x:Name="InfoPanel"
                            Grid.Column="3" 
                            Background="{StaticResource TgPanelBg}"
                            BorderBrush="{StaticResource TgBorder}"
                            BorderThickness="1,0,0,0"
                            Visibility="Visible">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel Padding="24,20">
                                <!-- ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° -->
                                <Border Width="100" Height="100" CornerRadius="50" HorizontalAlignment="Center" Margin="0,0,0,16">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="#8B5CF6" Offset="0"/>
                                            <GradientStop Color="#EC4899" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <TextBlock x:Name="InfoAvatar" 
                                             Text="A"
                                             FontSize="40"
                                             FontWeight="Bold"
                                             Foreground="White"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center"/>
                                </Border>

                                <TextBlock x:Name="InfoUsername" 
                                         Text="Alice"
                                         FontSize="20"
                                         FontWeight="Bold"
                                         Foreground="{StaticResource TgTextPrimary}"
                                         HorizontalAlignment="Center"
                                         Margin="0,0,0,4"/>

                                <TextBlock Text="online"
                                         FontSize="14"
                                         Foreground="{StaticResource TgOnline}"
                                         HorizontalAlignment="Center"
                                         Margin="0,0,0,24"/>

                                <!-- Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ -->
                                <TextBlock Text="Actions" 
                                         FontSize="14"
                                         FontWeight="SemiBold"
                                         Foreground="{StaticResource TgTextSecondary}"
                                         Margin="0,0,0,12"/>

                                <Button Style="{StaticResource TgMenuItem}" Height="48">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ðŸ”" FontSize="20" Width="30"/>
                                        <TextBlock Text="Search" FontSize="15" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>

                                <Button Style="{StaticResource TgMenuItem}" Height="48">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ðŸ”•" FontSize="20" Width="30"/>
                                        <TextBlock Text="Mute" FontSize="15" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>

                                <Button Style="{StaticResource TgMenuItem}" Height="48">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ðŸ—‘ï¸" FontSize="20" Width="30"/>
                                        <TextBlock Text="Clear History" FontSize="15" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>

                                <Button Style="{StaticResource TgMenuItem}" Height="48">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ðŸš«" FontSize="20" Width="30"/>
                                        <TextBlock Text="Block" FontSize="15" VerticalAlignment="Center" Foreground="{StaticResource TgRed}"/>
                                    </StackPanel>
                                </Button>

                                <!-- Ðž ÑÐµÐ±Ðµ -->
                                <TextBlock Text="Info" 
                                         FontSize="14"
                                         FontWeight="SemiBold"
                                         Foreground="{StaticResource TgTextSecondary}"
                                         Margin="0,24,0,12"/>

                                <Border Background="{StaticResource TgCardBg}" 
                                      CornerRadius="10"
                                      Padding="16,12">
                                    <StackPanel>
                                        <TextBlock Text="Username"
                                                 FontSize="13"
                                                 Foreground="{StaticResource TgTextSecondary}"
                                                 Margin="0,0,0,4"/>
                                        <TextBlock x:Name="InfoUsernameDetail"
                                                 Text="@alice"
                                                 FontSize="15"
                                                 Foreground="{StaticResource TgTextPrimary}"/>
                                    </StackPanel>
                                </Border>

                                <!-- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹ -->
                                <TextBlock Text="Notifications" 
                                         FontSize="14"
                                         FontWeight="SemiBold"
                                         Foreground="{StaticResource TgTextSecondary}"
                                         Margin="0,24,0,12"/>

                                <ToggleButton x:Name="NotificationsToggle"
                                            Content="Enable notifications"
                                            IsChecked="True"
                                            Foreground="{StaticResource TgTextPrimary}"
                                            Background="{StaticResource TgCardBg}"
                                            BorderThickness="0"
                                            Padding="16,12"
                                            HorizontalContentAlignment="Left"
                                            FontSize="15"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>

                    <!-- Ð’Ð«Ð”Ð’Ð˜Ð–ÐÐžÐ• ÐœÐ•ÐÐ® Ð¡Ð›Ð•Ð’Ð -->
                    <Border x:Name="SideMenu"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Background="{StaticResource TgPanelBg}"
                            Visibility="Collapsed"
                            Width="340"
                            HorizontalAlignment="Left">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" Opacity="0.5" BlurRadius="20" ShadowDepth="0"/>
                        </Border.Effect>
                        
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Ð¨Ð°Ð¿ÐºÐ° Ð¼ÐµÐ½ÑŽ -->
                            <Border Grid.Row="0" 
                                  Background="{StaticResource TgGradient}"
                                  Padding="24,20">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <Border Width="64" Height="64" CornerRadius="32" 
                                          HorizontalAlignment="Left"
                                          Margin="0,0,0,12">
                                        <Border.Background>
                                            <SolidColorBrush Color="White" Opacity="0.3"/>
                                        </Border.Background>
                                        <TextBlock x:Name="MenuAvatarText" 
                                                 Text="U"
                                                 FontSize="28"
                                                 FontWeight="Bold"
                                                 Foreground="White"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"/>
                                    </Border>

                                    <TextBlock x:Name="MenuUsernameText"
                                             Grid.Row="1"
                                             Text="Username"
                                             FontSize="18"
                                             FontWeight="Bold"
                                             Foreground="White"
                                             Margin="0,0,0,4"/>

                                    <TextBlock x:Name="MenuPhoneText"
                                             Grid.Row="2"
                                             Text="+7 953 405 2704"
                                             FontSize="14"
                                             Foreground="White"
                                             Opacity="0.8"/>
                                </Grid>
                            </Border>

                            <!-- ÐŸÑƒÐ½ÐºÑ‚Ñ‹ Ð¼ÐµÐ½ÑŽ -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <StackPanel Padding="0,8">
                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ‘¤" FontSize="24" Width="40"/>
                                            <TextBlock Text="My Profile" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ’¼" FontSize="24" Width="40"/>
                                            <TextBlock Text="My Wallet" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ‘¥" FontSize="24" Width="40"/>
                                            <TextBlock Text="Create Group" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ“¢" FontSize="24" Width="40"/>
                                            <TextBlock Text="Create Channel" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ‘¥" FontSize="24" Width="40"/>
                                            <TextBlock Text="Contacts" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ“ž" FontSize="24" Width="40"/>
                                            <TextBlock Text="Calls" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ”–" FontSize="24" Width="40"/>
                                            <TextBlock Text="Saved Messages" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52" Click="Settings_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="âš™ï¸" FontSize="24" Width="40"/>
                                            <TextBlock Text="Settings" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Border Height="1" Background="{StaticResource TgBorder}" Margin="16,8"/>

                                    <Button Style="{StaticResource TgMenuItem}" Height="52">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸŒ™" FontSize="24" Width="40"/>
                                            <TextBlock Text="Night Mode" FontSize="15" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>
